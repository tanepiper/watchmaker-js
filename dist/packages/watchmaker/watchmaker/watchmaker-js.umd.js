"use strict";function e(e,t,n){t=t||20,n=n||{splitChar:" ",joinChar:" "},console.log(e);for(var r=(e||"").split(n.splitChar),o=[],a="",i=0;i<r.length;i++){var s=r[i],u=r[i+1],c=[a=[a,s].join(" ").trim(),u].join(" ");u&&c.length>t&&(o.push(""+a),a="")}return a&&o.push(a),o}function t(t,n,r,o){n=n||4;for(var a=[],i=e(t,r=r||18),s=!1;!s;){var u=i.splice(0,n);0===u.length?s=!0:a.push(u.join("\n"))}return a}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("locale");function r(e,n,r){return r||(n=t(n)[0]),E.showAlert(n,e)}var o=require("Storage");exports.convertStringToPage=t,exports.createAlert=r,exports.createCountUp=function(e,t,n){var r,o,a=e/(n=n||1);return{start:new Promise((function(e){o=e;var i=1;r=setInterval((function(){if(i===a)return o(!1),clearInterval(r);t(i*n),i++}),1e3*n),t(0)})),cancel:function(){clearInterval(r),o(!0)}}},exports.createCountdown=function(e,t,n){var r,o,a=e/(n=n||1);return{start:new Promise((function(i){o=i;var s=1;r=setInterval((function(){if(s===a)return o(!1),clearInterval(r);t(e-s*n),s++}),1e3*n),t(e)})),cancel:function(){clearInterval(r),o(!0)}}},exports.createMenu=function(e,t,n,r,o){E.showMenu();var a={"":{title:e}};return t&&(a[" "]={value:t}),Object.keys(n).forEach((function(e){a[e]=n[e]})),r&&(a["< Back"]=r),o&&(a["<< Exit"]=o),E.showMenu(a)},exports.createMessage=function(e,n,r,o){return r=r||0,o||(n=t(n)[0]),new Promise((function(t){E.showMessage(n,e),setTimeout((function(){return t()}),r)}))},exports.createScrollPrompt=function(t,r,o,a){o||(o={Yes:!0,No:!1}),a=a||0;var i=Object.keys(o),s=e(r);function u(e){g.clear(1),g.reset().setFont("6x8",2).setFontAlign(0,0);var r=g.getWidth(),o=g.getHeight();if(t){t=n.translate(t),g.drawString(t,r/2,34);var a=(g.stringWidth(t)+16)/2;g.fillRect(r/2-a,44,r/2+a,44)}var u=(o-16*s.length)/2;s.forEach((function(e,t){return g.drawString(n.translate(e),r/2,u+16*t)}));var c,l=n.translate(i[e]);c=16+g.stringWidth(l);var f=(r-c)/2,h=o-40,v=g.stringWidth(l),p=2+v/2,m=[(f+=(v+16)/2)-p,h-12,f+p,h-12,f+p+4,h-8,f+p+4,h+8,f+p,h+12,f-p,h+12,f-p-4,h+8,f-p-4,h-8,f-p,h-12];g.setColor(759).fillPoly(m).setColor(-1).drawPoly(m).drawString(l,f,h+1),g.setColor(e?-1:0),g.fillPoly([120,h-29,106,h-15,134,h-15]),g.setColor(i.length-1===e?0:-1),g.fillPoly([120,h+12+4+14,106,h+12+4,134,h+12+4]),g.setColor(-1).flip()}return Bangle.btnWatches&&(Bangle.btnWatches.forEach(clearWatch),Bangle.btnWatches=void 0),g.clear(1),Bangle.drawWidgets(),u(a),new Promise((function(e){Bangle.btnWatches=[setWatch((function(){a>0&&u(--a)}),BTN1,{repeat:1}),setWatch((function(){a<i.length-1&&u(++a)}),BTN3,{repeat:1}),setWatch((function(){g.clear(1),e(o[i[a]])}),BTN2,{repeat:1})]}))},exports.createSelectPage=function(e,n,r,o,a){return o=o||0,a||(n=t(n)[0]),E.showPrompt(n,{title:e,buttons:r,selected:o})},exports.formatTimestampToDate=function(e){var t=new Date(e);return[""+t.getFullYear(),""+t.getMonth(),""+t.getDate()].map((function(e){return e.length<2?"0"+e:""+e})).join("-")},exports.formatTimestampToTime=function(e,t){var n=new Date(e),r=[""+n.getHours(),""+n.getMinutes(),""+n.getSeconds()].map((function(e){return e.length<2?"0"+e:""+e})).join(":");return t?r:r.substr(0,5)},exports.getFixedStringLines=e,exports.lug=function(e,t){var n={name:e,state:{},images:{},routes:t.routes||{home:{view:function(){return E.showAlert("No Lug Home Set")}}},currentRoute:"",loadImage:function(e){var t=o.read(n.name+"."+e+".img");return n.images[e]=t,t},getImage:function(e){return n.images[e]},getText:function(e){var t=o.readJSON(n.name+".text.json",1);return e?e.includes(".")?e.split(".").reduce((function(e,t){return e[t]&&e[t]||e}),t||{}):t[e]:t},getGlobalSettings:function(e){var t=o.readJSON("setting.json",1);return t&&t[e]?t[e]:t},getSettings:function(e){var t=o.readJSON(n.name+".settings.json",1);return t&&t[e]?t[e]:t},saveSettings:function(e){return o.writeJSON(n.name+".settings.json",e)},saveData:function(e,t){return new Promise((function(r,a){try{var i=o.open(n.name+"."+e+".json","w"),s="";if(Array.isArray(t))for(var u=0;u<t.length;u++)s+=JSON.stringify(t[u])+"\n";else s=JSON.stringify(t)+"\n";i.write(""+s),r()}catch(e){a(e)}}))},getData:function(e,t){return new Promise((function(r,a){try{var i=o.open(n.name+"."+e+".json","r"),s=[];if(t)for(var u=0;u<t;u++){if(!(c=i.readLine()))break;s.push(JSON.parse(c))}else for(var c=i.readLine();void 0!==c;)s.push(JSON.parse(c)),c=i.readLine();r(s)}catch(e){a(e)}}))},setState:function(e,t){n.state[e]=t},getState:function(e){return n.state[e]},goTo:function(e){for(var o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];t.onChange&&t.onChange(n),n.routes[e]?(n.routes[e].view.apply(n,o),n.currentRoute=e):r("Lug Error","Route "+e+" not found").then((function(){return n.routes.home.view.apply(n,o)}))}};return t.init(n),t.first&&setTimeout((function(){return t.first(n)}),1e3),n};
